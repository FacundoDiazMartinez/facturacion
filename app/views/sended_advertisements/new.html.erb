<div class="p-4">
  <%= title_helper 'Seleccione destinatarios' %>
</div>

<div id="form">
  <div class="page-section">
    <div class="card">
      <div class="card-body" id="clients_table">
        <%= render 'clients_table' %>
      </div>
    </div>
  </div>
</div>

<%= form_for @sended_advertisement do |form| %>

  <%= form.hidden_field :clients_data %>
  <%= form.hidden_field :advertisement_id %>
  <center>
    <%= button_tag "#{icon('fas', 'envelope')} Enviar".html_safe, type: 'submit', class: 'btn btn-primary' %>
  </center>
<% end %>


<script>

  var idsArray = [];

  $(document).on("change", "input", function(){
    if ($(this).is(":checked")) {
      idsArray.push($(this).val());
    } else {
      // idsArray.remove($(this).val());
      var index = idsArray.indexOf($(this).val());
      idsArray.splice(index, 1);
    }
    $("#sended_advertisement_clients_data").val(idsArray.join(", "));
  })


</script>
