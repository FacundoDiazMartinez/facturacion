<%= form_with(model: service, local: true, class: 'directUpload', data: { 'form-data' => (@s3_direct_post.fields), 'url' => @s3_direct_post.url, 'host' => URI.parse(@s3_direct_post.url).host}) do |f| %>
  <% if service.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(service.errors.count, "error") %> prohibited this service from being saved:</h2>
      <ul>
      <% service.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <!-- IMAGEN DEL servicio -->
  <p class="text-muted">Selecciona una imágen para el servicio</p>
  <div class="card mb-4 card-shadow" style="width:30%;margin:auto;">
    <div class="comp_container caption captionload">
      <img src="/images/load.gif" width="80%">
    </div>
    <img class="card-img-top" src="<%= @service.photo %>" alt="Añadir foto" id="image"  width="80%">
    <div hidden>
      <%= f.file_field :photo, :class => 'form-control', id: 'file_input' %>
    </div>
  </div>
  <!-- IMAGEN DEL servicio -->

  <!-- INFORMACIÓN BÁSICA -->
  <p class="text-muted">Completa los datos principales del servicio</p>
  <div class="card mb-4 card-shadow">
    <div class="card-body">

      <div class="form-row">
        <div class="form-group col-md-6">
          <%= f.label :name, "Nombre*" %>
          <%= f.text_field :name, :class => 'form-control', required: true %>
        </div>
        <div class="form-group col-md-6">
          <%= f.label :code, "Código*" %>
          <%= f.text_field :code, :class => 'form-control', required: true %>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group col-md-6">
          <%= f.label :product_category_id, "Categoría" %>
          <div class="row">
            <div class="col-sm-12" id="product_category_select">
              <%= f.select :product_category_id, current_user.company.product_categories.all.map{|pc| [pc.name, pc.id]}, {include_blank: "Sin categoría"}, {:class => 'form-control'} %>
            </div>
          </div>
        </div>
        <div class="form-group col-md-6">
          <%= f.label :cost_price, "Precio de costo*" %>
          <%= f.number_field :cost_price, :class => 'form-control', required: true, step: '.01' %>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group col-md-6">
          <%= f.label :gain_margin, "Márgen de ganancia (%)*" %>
          <%= f.number_field :gain_margin, :class => 'form-control', required: true, step: '.01' %>
        </div>
        <div class="form-group col-md-6">
          <%= f.label :net_price, "Precio neto*" %>
          <%= f.number_field :net_price, :class => 'form-control', required: true, step: '.01' %>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group col-md-6">
          <%= f.label :iva_aliquot, "Alícuota de IVA" %>
          <%= f.select :iva_aliquot, Afip::ALIC_IVA.map{|iva, id| [id, iva]}, {}, {class: 'form-control'} %>
        </div>
        <div class="form-group col-md-6">
          <%= f.label :price, "Precio final*" %>
          <%= f.number_field :price, :class => 'form-control', required: true, step: '.01' %>
        </div>
      </div>
    </div>
  </div>
  <!-- COSTOS Y GANANCIAS -->


  <center>
    <%= save_button %>
  </center>
<% end %>

<div class="modal fade bd-example-modal-lg" id="product_category_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div id="product_category_form">
      </div>
    </div>
  </div>
</div>
