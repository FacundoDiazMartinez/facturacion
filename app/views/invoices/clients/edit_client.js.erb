<% if not @client.errors.any? %>
	$("#myModal").modal('hide');
	$('#myModal').on('hidden.bs.modal', function (e) {
		<% if @client.enabled %>
  	$("#client_form").html("<%= j render '/invoices/client_column' %> ");
  	$("#invoice_client_id").val("<%= @client.id %>");
		$("#associated_invoice").attr("disabled", "disabled");

  	var options = <%= raw InvoiceManager::CbteTypesGetter.call(current_company, @client).to_json %>
  	$('#invoice_cbte_tipo').html("");
  	$.each(options, function(i, option) {
	    $('#invoice_cbte_tipo').append( new Option(option[0],option[1]) );
		});

		<% if @client.saldo.to_f < 0.0 && @client.valid_for_account %>
			$("#saldo_disponible").html("Saldo disponible en cuenta corriente: $<%= -@client.saldo.to_f %>");
		<% else %>
			$("#saldo_disponible").html("");
		<% end %>
		$("#invoice_cbte_tipo").trigger("change");

		<% else %>
			alert("El cliente seleccionado est√° inhabilitado para operaciones de venta.")
		<% end %>
	});
<% else %>
	$("#client_errors").html("<%= j error_explanation(@client) %>");
<% end %>

$("#invoice_total").val("0.00");
$("#total_left").val("0.00");
$("#tributes > tbody > tr").each(function(){ // >>>>>>>>>>>>> Insercion de base imponible en tributos (suma de subtotales de cada concepto)
	base_imp = 0;
	e = $(this).find("input.base_imp");
	e.val(base_imp);
	alic 	 = parseFloat(e.closest("tr.fields").find("input.alic").val());
	e.closest("tr.fields").find("input.importe").val((base_imp * ( alic/100)).toFixed(2));
})

$("#div_iauthorized").html("<%= j render template: '/invoices/authorized/index.html.erb'%>")
